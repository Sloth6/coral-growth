#!/usr/bin/env python3
from __future__ import division, print_function

import time
import random
import os, sys

sys.path.append(os.path.abspath('..'))
random.seed(123)
import MultiNEAT as NEAT
from coral_growth.coral import Coral
from coral_growth.simulate import simulate_network

time_steps = 20

world_configs = {
    'max_polyps': 5000,
    'growth_scalar': .25,
    'max_angle': .98 * 2 * 3.14159,
    'max_face_growth': 2.0,
    'morphogens': [{ 'diffU': 0.01, 'diffV': 0.005, 'F': 0.02, 'K': 0.05 }]
}

class NetworkDummy(object):
    def Input(self, input):
        self.input = input

    def ActivateFast(self):
        pass

    def Flush(self):
        pass

    def Output(self):
        out = [0] * (Coral.num_outputs + len(world_configs['morphogens']))
        out[0] = random.random()
        out[1] = 1 if random.random() < .2 else 0
        return out

start = time.time()
net = NEAT.NeuralNetwork()
simulate_network(time_steps, NetworkDummy(), [world_configs], verbose=True)
print('finished in', time.time() - start)
