#!/usr/bin/env python3
from __future__ import division, print_function
import os, sys, time, random
sys.path.append(os.path.abspath('..'))
random.seed(123)
import MultiNEAT as NEAT
from coral_growth.coral import Coral
from coral_growth.simulate import simulate_genome
from coral_growth.parameters import Parameters

params = Parameters()
params.addMorphogen()
params.addMorphogen()

num_inputs = Coral.num_inputs + params.polyp_memory + \
             params.n_morphogens*(params.morph_thresholds - 1)

num_outputs = Coral.num_outputs + params.polyp_memory + params.n_morphogens

usig = NEAT.ActivationFunction.UNSIGNED_SIGMOID
genome = NEAT.Genome(0, num_inputs, 0, num_outputs, False, usig, usig, 0, params)

start = time.time()
simulate_genome(genome, genome.GetGenomeTraits(), [params])
print('finished in', time.time() - start)

total = sum(coral.function_times.values())
for k, v in sorted(coral.function_times.items()):
    print(k, v, v/ total)
print()
