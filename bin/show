#!/usr/bin/env python3
import sys, os
sys.path.append(os.path.abspath('..'))
from coral_growth.simulate import simulate_genome
from coral_growth.viewer import AnimationViewer

if __name__ == '__main__':
    assert(len(sys.argv) >= 2)
    width = 1400
    height = 1050

    directories = sys.argv[1:]
    print(directories)

    if sys.argv[1].isdigit():
        width = int(sys.argv[1])
        directories = sys.argv[2:]

    if len(sys.argv) > 2 and sys.argv[2].isdigit():
        height = int(sys.argv[2])
        directories = sys.argv[3:]

    print(width, height)

    all_files = []

    for folder in directories:
        folder += '/0'
        files = [f for f in os.listdir(folder) if '.coral.obj' in f]
        files = sorted(files, key=lambda f: int(f.split('.')[0]))
        files = [os.path.join(folder, f) for f in files]
        all_files.extend(files)

        if len(directories) > 1:
            for _ in range(5):
                all_files.append(all_files[-1])

    view = AnimationViewer(all_files, (width, height))
    # view = AnimationViewer(all_files, (600, 1200))
    # view = AnimationViewer(all_files, (600, 600), (1.0, 1.0, 1.0, 0.0))
    view.main_loop()
